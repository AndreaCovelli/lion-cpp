#include "lion/math/linear_algebra.h"
#include "lion/math/matrix_extensions.h"
#include "gtest/gtest.h"


TEST(Linear_algebra_test, lusolve)
{

    std::vector<double> a = {0.4217612826262750, 0.9157355251890671, 0.7922073295595544, 0.9594924263929030, 0.6557406991565868, 
                             0.0357116785741896, 0.8491293058687771, 0.9339932477575505, 0.6787351548577735, 0.7577401305783334, 
                             0.7431324681249162, 0.3922270195341682, 0.6554778901775566, 0.1711866878115618, 0.7060460880196088, 
                             0.0318328463774207};
    std::vector<double> b = {0.276922984960890,  0.046171390631154,  0.097131781235848,  0.823457828327293};

    std::vector<double> x = {-1.259402919113526,  1.400419316576348,  2.029745875076509, -2.269918588304513};

    EXPECT_EQ(a.size(),16);      
    EXPECT_EQ(lusolve(b.data(), a.data(), 4, 1), 0);

    for (size_t i = 0; i < 4; ++i)
        EXPECT_NEAR(b[i], x[i], 2.0e-15);
}
